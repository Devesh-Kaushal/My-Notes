@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    /* Safe notion-like defaults */
    --bg-primary: #ffffff;
    --bg-secondary: #f7f7f5;
    /* Sidebar */
    --bg-hover: #efefef;
    --text-primary: #37352f;
    --text-secondary: #787774;
    --text-tertiary: #aeb0b2;
    --border-color: #e9e9e7;
    --scroll-thumb: #d3d1cb;
    --scroll-thumb-hover: #aeaca6;
  }

  [data-theme='dark'] {
    --bg-primary: #191919;
    --bg-secondary: #202020;
    --bg-hover: #2c2c2c;
    --text-primary: #d4d4d4;
    --text-secondary: #9b9b9b;
    --text-tertiary: #5a5a5a;
    --border-color: #2a2a2a;
    --scroll-thumb: #37352f;
    --scroll-thumb-hover: #4a4843;
  }

  body {
    background-color: var(--bg-primary);
    color: var(--text-primary);
    @apply antialiased overflow-hidden transition-colors;
  }
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: transparent;
}

::-webkit-scrollbar-thumb {
  background: var(--scroll-thumb);
  border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--scroll-thumb-hover);
}

/* Tiptap Styles */
.ProseMirror {
  outline: none !important;
}

/* Placeholder */
.ProseMirror p.is-editor-empty:first-child::before {
  color: var(--text-secondary);
  content: attr(data-placeholder);
  float: left;
  height: 0;
  pointer-events: none;
}

/* Typography Overrides */
.prose h1 {
  @apply font-bold mb-2 text-4xl;
  color: var(--text-primary);
}

.prose h2 {
  @apply font-semibold mt-6 mb-2 text-2xl;
  color: var(--text-primary);
}

.prose h3 {
  @apply font-semibold mt-4 mb-2 text-xl;
  color: var(--text-primary);
}

.prose p {
  @apply mb-3 leading-relaxed;
  color: var(--text-primary);
}

.prose strong {
  color: var(--text-primary);
}

.prose em {
  color: var(--text-primary);
}

/* Lists */
.prose ul {
  @apply list-disc list-outside ml-4 mt-2;
}

.prose ol {
  @apply list-decimal list-outside ml-4 mt-2;
}

.prose li p {
  @apply m-0;
}

/* Blockquote */
.prose blockquote {
  border-left: 4px solid var(--border-color);
  padding-left: 1rem;
  margin: 1rem 0;
  color: var(--text-secondary);
  font-weight: normal;
  font-style: normal;
}

/* Code Block */
.prose pre {
  background-color: var(--bg-secondary);
  color: var(--text-secondary);
  @apply rounded p-4 my-4 overflow-x-auto text-sm font-mono border border-transparent;
}

[data-theme='dark'] .prose pre {
  background-color: #2c2c2c;
  color: #dadada;
}

.prose code {
  background-color: var(--bg-hover);
  color: #eb5757;
  @apply rounded px-1.5 py-0.5 text-sm font-mono;
}

.prose pre code {
  background-color: transparent;
  color: inherit;
  padding: 0;
}

/* Task List */
ul[data-type="taskList"] {
  list-style: none;
  padding: 0;
  margin: 0;
}

li[data-type="taskItem"] {
  display: flex;
  flex-direction: row;
  /* Ensure row layout */
  align-items: flex-start;
  /* Align checkbox with top of text */
  margin-bottom: 0.25rem;
}

li[data-type="taskItem"] label {
  margin-right: 0.75rem;
  /* Space between checkbox and text */
  user-select: none;
  cursor: pointer;
  display: flex;
  /* Fix for alignment */
  align-items: center;
  height: 1.5rem;
  /* Match line height of text roughly */
}

li[data-type="taskItem"] div {
  flex: 1;
  /* Text takes remaining space */
  margin: 0;
  padding: 0;
}

li[data-type="taskItem"] input[type="checkbox"] {
  appearance: none;
  background-color: transparent;
  margin: 0;
  width: 1rem;
  height: 1rem;
  border: 2px solid var(--text-secondary);
  /* Custom border */
  border-radius: 3px;
  cursor: pointer;
  position: relative;
  top: 2px;
  /* Slight optical adjustment */
}

li[data-type="taskItem"] input[type="checkbox"]:checked {
  background-color: #2eaadc;
  /* Notion blue-ish */
  border-color: #2eaadc;
}

li[data-type="taskItem"] input[type="checkbox"]:checked::after {
  content: '';
  position: absolute;
  left: 4px;
  top: 1px;
  width: 4px;
  height: 8px;
  border: solid white;
  border-width: 0 2px 2px 0;
  transform: rotate(45deg);
}

/* Checked State - Strikethrough */
li[data-type="taskItem"][data-checked="true"]>div,
li[data-type="taskItem"][data-checked="true"]>div>p {
  text-decoration: line-through;
  color: var(--text-tertiary);
  /* Lighter gray for done items */
}

/* Navigation & Page Links */
.page-link-node {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  padding: 0 0.25rem;
  border-radius: 0.25rem;
  color: var(--text-primary);
  text-decoration: none;
  cursor: pointer;
  background-color: transparent;
  transition: background-color 0.2s;
  border-bottom: 1px solid var(--border-color);
  /* Subtle underline hint */
}

.page-link-node:hover {
  background-color: var(--bg-hover);
}

.page-link-node::before {
  content: 'ðŸ“„';
  /* Fallback emoji if no icon passed */
  font-size: 1.1em;
}